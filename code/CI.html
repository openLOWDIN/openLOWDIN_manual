

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configuration Interaction, CI &mdash; openLOWDIN 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
    <link rel="shortcut icon" href="../_static/openLowdin_logo_v2_white_black.svg"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e031e9a9"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Non-Orthogonal Configuration Interaction, NOCI" href="NOCI.html" />
    <link rel="prev" title="Propagathor Theory, PT" href="PT.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            openLOWDIN
              <img src="../_static/openLowdin_logo_v2_white_black.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../openLOWDIN/about.html">     About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openLOWDIN/developers_and_contributors.html">     Developers and contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openLOWDIN/installation.html">     Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openLOWDIN/getting_started.html">     Getting started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="code.html">     List of methods/options</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">     Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib.html">     Lib</a></li>
<li class="toctree-l1"><a class="reference internal" href="control.html">     CONTROL</a></li>
<li class="toctree-l1"><a class="reference internal" href="outputs.html">     Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrals.html">     Integrals</a></li>
<li class="toctree-l1"><a class="reference internal" href="HF.html">     HF</a></li>
<li class="toctree-l1"><a class="reference internal" href="scf.html">     SCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="potentials.html">     Potentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="properties.html">     Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="DFT.html">     DFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="MBPT.html">     MBPT</a></li>
<li class="toctree-l1"><a class="reference internal" href="PT.html">     PT</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">     CI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ci-wavefunction">CI Wavefunction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#selected-ci-sci">Selected CI, SCI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#natural-orbitals">Natural orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ci-input-options">CI Input options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="NOCI.html">     NOCI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorials.html">     List of tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/positrons.html">     Positronic systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/positronCovalentBond.html">     Positron covalent bond</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/nuclei.html">     Quantum nuclei</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/mp2example.html">     MP2 example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/pt2example.html">     PT2 example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/toep2example.html">     TOEP2 example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/pt3example.html">     PT3 example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/muons.html">     Negative muons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/qdo.html">     Quantum Drude Oscillators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/extPotentials.html">     External potentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/moldenFilesExample.html">     Molden files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cubesFilesExample.html">     Cubes files</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bibliography/biblio.html">     Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">openLOWDIN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Configuration Interaction, CI</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/code/CI.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="configuration-interaction-ci">
<span id="ci"></span><h1>Configuration Interaction, CI<a class="headerlink" href="#configuration-interaction-ci" title="Permalink to this heading"></a></h1>
<section id="ci-wavefunction">
<h2>CI Wavefunction<a class="headerlink" href="#ci-wavefunction" title="Permalink to this heading"></a></h2>
<p>The APMO/CI wave function is written as a linear combination of CI configurations</p>
<div class="math notranslate nohighlight">
 \begin{equation}
   | \Psi_{\text{CI}} \rangle = \sum_{I}^{N_{\text{conf}}} c_I|\Psi_I\rangle
\end{equation}</div><p>as products of Slater determinants between all quantum species</p>
<div class="math notranslate nohighlight">
   \begin{equation}
    | \Psi_I \rangle =
    \prod_{\alpha}^{N_{sp}} | D_I \rangle_{\alpha} = | D_I \rangle_{\alpha}  | D_I \rangle_{\beta}
    | D_I \rangle_{\gamma} \dots
 \end{equation}</div><p>where each is built as excitations within each type of quantum species, written in second quantization as:</p>
<div class="math notranslate nohighlight">
 \begin{equation}
  | D_I \rangle_{\alpha} = a_i^{\dagger}a_j^{\dagger}\dots a_{N_{\alpha}}^{\dagger} | \rangle_{\alpha}
  \end{equation}</div><p>For example,</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../_images/conf.svg"><img alt="Schematic of a configuration" src="../_images/conf.svg" width="400px" /></a>
<figcaption>
<p><span class="caption-text">Schematic of multicomponent CI configuration</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Normally in CI, those configurations are group together according to the excitation level</p>
<div class="math notranslate nohighlight">
 \begin{equation}
    | \Psi_{\text{CI}} \rangle = c_0|\Psi_0\rangle
    + \sum_{\alpha}\sum_{ia \in \alpha} c_i^a|\Psi_i^a \rangle
    +\sum_{\alpha,\beta}\sum_{\substack{ia\in\alpha\\jb\in\beta}} c_{ij}^{ab}|\Psi_{ij}^{ab} \rangle
    +\sum_{\alpha,\beta}\sum_{\substack{ia\in\alpha\\jb\in\alpha\\kc\in\beta}} c_{ijk}^{abc}|\Psi_{ijk}^{abc} \rangle
    + \cdots
 \end{equation}</div><p>leading to all singles excitations for all species, doubles within the same species (intraspecies), doubles as products of two single excitations from two different species (interspecies) for all possible pairs, as well as triples, quadrupoles, … and so on.</p>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../_images/CI_confs.svg"><img alt="Schematic of a configuration" src="../_images/CI_confs.svg" width="800px" /></a>
<figcaption>
<p><span class="caption-text">Schematic of multicomponent CI wave function</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Given that wavefunction, the CI Hamiltonian matrix are computed following Slater’s rules taking into accound that the multispecies potential operator are still a two-body operator at most.</p>
<p>Identical determinants:</p>
<div class="math notranslate nohighlight">
\begin{equation}
\langle \Phi_I | \hat{H} | \Phi_I \rangle =
\sum_{\alpha}^{N_s} \sum_i^{N^{\alpha}} [i|\hat{h}|i] +
\sum_{\alpha}^{N_s} \sum_i^{N^{\alpha}}\sum_{j&gt;i}^{N^{\alpha}} ([ii|jj]-[ij|ji]) +
\sum_{\alpha}^{N_s}\sum_{\beta &gt; \alpha}^{N_s} \sum_{\substack{i \in \alpha \\ j \in \beta}}^{N^{\alpha}N^{\beta}} [ii|jj]
\end{equation}</div><p>One spin-orbital different</p>
<div class="math notranslate nohighlight">
\begin{align}
&amp; | \Phi_I \rangle = | \cdots i_{\alpha} \cdots \rangle \prod_{\beta \ne \alpha}^{N_s} | \beta(I)\rangle \quad \quad
 | \Phi_J \rangle = | \cdots j_{\alpha} \cdots \rangle
\prod_{\beta \ne \alpha}^{N_s} | \beta(I)\rangle \\
&amp; \langle \Phi_I | \hat{H} | \Phi_J \rangle = [i|\hat{h}|i] +  \sum_k^{N^{\alpha}} ([ij|kk]-[ik|kj]) +
\sum_{\beta \ne \alpha}^{N_s} \sum_{k \in\beta}^{N^{\beta}}[ij|kk], \ \ i,j \in \alpha
\end{align}</div><p>Two spin-orbital different, same species</p>
<div class="math notranslate nohighlight">
\begin{align}
&amp; | \Phi_I \rangle = | \cdots i_{\alpha}j_{\alpha}  \cdots \rangle \prod_{\beta \ne \alpha}^{N_s} | \beta(I)\rangle \quad \quad | \Phi_J \rangle = | \cdots k_{\alpha}l_{\alpha}  \cdots \rangle
\prod_{\beta \ne \alpha}^{N_s} | \beta(I)\rangle\\
&amp; \langle \Phi_I | \hat{H} | \Phi_J \rangle =
[ik|jl]-[il|jk], \ \ i,j,k,l \in \alpha
\end{align}</div><p>One spin-orbital different for two different quantum species</p>
<div class="math notranslate nohighlight">
\begin{align}
&amp; | \Phi_I \rangle = | \cdots i_{\alpha} \cdots \rangle
| \cdots k_{\beta} \cdots \rangle
\prod_{\substack{\gamma \ne \alpha\\ \gamma\ne\beta}}^{N_s} | \gamma(I)\rangle \\ &amp;
 | \Phi_J \rangle =  | \cdots j_{\alpha} \cdots \rangle
| \cdots l_{\beta} \cdots \rangle
\prod_{\substack{\gamma \ne \alpha\\ \gamma\ne\beta}}^{N_s} | \gamma(I)\rangle \\
&amp; \langle \Phi_I |  \hat{H} |  \Phi_J \rangle =  [ij| kl], \ \ i,j \in \alpha ,k,l \in \beta
\end{align}</div><p>More than two spin orbital different within same species or more than two different species, differing in one spin orbital.</p>
<div class="math notranslate nohighlight">
\begin{align}
&amp; \langle \Phi_I | \hat{H} | \Phi_J \rangle = 0
\end{align}</div><p>The combinational CI coefficients <span class="math notranslate nohighlight">\(c\)</span> are obtained variationally by solving the CI eigenvalue problem <span class="math notranslate nohighlight">\(\textbf{Hc} = E\textbf{c}\)</span>.
Due to the size of the Hamiltonian Matrix <span class="math notranslate nohighlight">\(\textbf{H}\)</span>, it is necessary to use iterative techniques for diagonalization of real symmetric matrices avoiding the memory storage of the full matrix. Davidson’s method is the most used technique to find the lowest eigenvalues and eigenvectors. Here, the storage requirements of <span class="math notranslate nohighlight">\(\textbf{H}\)</span> can be greatly reduced by direct calculation of a matrix-vector product of the form <span class="math notranslate nohighlight">\(\textbf{Hc} = \sigma\)</span>.</p>
</section>
<section id="selected-ci-sci">
<h2>Selected CI, SCI<a class="headerlink" href="#selected-ci-sci" title="Permalink to this heading"></a></h2>
<p>In openLOWDIN, the CI techniques aimed to select the most relevant configurations within the whole CI space are encompassed as the SCI family. These are usually categorized as stochastic or deterministic <span id="id1">[<a class="reference internal" href="../bibliography/biblio.html#id3" title="Janus J. Eriksen, Tyler A. Anderson, J. Emiliano Deustua, Khaldoon Ghanem, Diptarka Hait, Mark R. Hoffmann, Seunghoon Lee, Daniel S. Levine, Ilias Magoulas, Jun Shen, Norm M. Tubman, K. Birgitta Whaley, Enhua Xu, Yuan Yao, Ning Zhang, Ali Alavi, Garnet Kin Lic Chan, Martin Head-Gordon, Wenjian Liu, Piotr Piecuch, Sandeep Sharma, Seiichiro L. Ten-No, C. J. Umrigar, and Jürgen Gauss. The Ground State Electronic Energy of Benzene. J. Phys. Chem. Lett., 11(20):8922–8929, 2020. doi:10.1021/acs.jpclett.0c02621.">EAD+20</a>]</span>. Currently the code has implemented an extended multicomponent version of Adaptive Sampling CI, ASCI <span id="id2">[<a class="reference internal" href="../bibliography/biblio.html#id4" title="Norm M. Tubman, Joonho Lee, Tyler Y. Takeshita, Martin Head-Gordon, and K. Birgitta Whaley. A deterministic alternative to the full configuration interaction quantum Monte Carlo method. J. Chem. Phys., 145(4):044112, 2016. doi:10.1063/1.4955109.">TLT+16</a>]</span>.</p>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../_images/SCI_scheme.svg"><img alt="Schematic of SCI" src="../_images/SCI_scheme.svg" width="500px" /></a>
<figcaption>
<p><span class="caption-text">Schematic of SCI algorithm</span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="natural-orbitals">
<h2>Natural orbitals<a class="headerlink" href="#natural-orbitals" title="Permalink to this heading"></a></h2>
<p>In CI, natural orbitals are special orbitals defined as the eigenfunctions of the one-particle reduced CI density. Using them significantly improves CI convergence by reducing the number of configurations needed to describe electron correlation. This allows a CI calculation to achieve good accuracy with a much smaller set of configurations, as natural orbitals focus on those with large occupation numbers. Thus, the CI reduced density matrix for the CI <span class="math notranslate nohighlight">\(I\)</span>-th state is defined as</p>
<div class="math notranslate nohighlight">
\begin{equation}
\gamma_{\mu,\nu}^{CI(I)} = \langle \Psi^{(I)} | a^{\dagger}_{\mu} a_{\nu} | \Psi^{(I)} \rangle
\end{equation}</div><p>The natural orbitals are the eigenvectors of this density matrix, and the eigenvalues of the diagonalized density matrix are the natural occupation numbers, which indicate the importance of each natural orbital in the overall wave function.</p>
</section>
<section id="ci-input-options">
<h2>CI Input options<a class="headerlink" href="#ci-input-options" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">configurationInteractionLevel=</span></code> <em>[character]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">&quot;NONE&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numberOfCIStates=</span></code> <em>[integer]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CIdiagonalizationMethod=</span></code> <em>[character]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">&quot;DSYEVR&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CIdiagonalDressedShift=</span></code> <em>[character]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">&quot;NONE&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CIactiveSpace=</span></code> <em>[character]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">0!!Full</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CIstatesToPrint=</span></code> <em>[integer]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CImaxNCV=</span></code> <em>[integer]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">30</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CIsizeOfGuessMatrix=</span></code> <em>[integer]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">300</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CIstackSize=</span></code> <em>[integer]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">5000</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CIConvergence=</span></code> <em>[float]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">1E-4</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CImatvecTolerance=</span></code> <em>[float]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">1E-10</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CISaveEigenVector=</span></code> <em>[logical]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">.false.</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CILoadEigenVector=</span></code> <em>[logical]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">.false.</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CIJacobi=</span></code> <em>[logical]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">.false.</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CIBuildFullMatrix=</span></code> <em>[logical]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">.false.</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CIMadSpace=</span></code> <em>[integer]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">5</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CINaturalOrbitals=</span></code> <em>[logical]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">.false.</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CIPrintEigenVectorsFormat=</span></code> <em>[character]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">&quot;OCCUPIED&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CIPrintThreshold=</span></code> <em>[float]</em>
<em>Default</em> <code class="docutils literal notranslate"><span class="pre">1E-1</span></code></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="PT.html" class="btn btn-neutral float-left" title="Propagathor Theory, PT" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="NOCI.html" class="btn btn-neutral float-right" title="Non-Orthogonal Configuration Interaction, NOCI" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, openLOWDIN.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>